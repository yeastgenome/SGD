'''
Created on Sep 27, 2013

@author: kpaskov
'''

from go_enrichment.yeastmine_config import WEB_USER, WEB_PASS
from intermine.webservice import Service, ServiceError

SERVER = "http://yeastmine.yeastgenome.org/yeastmine/service"
GENE_OBJECT = "Gene"


def query_go_processes(bioent_format_names):
    if len(bioent_format_names) > 0:
        service = Service(SERVER, WEB_USER, WEB_PASS)
            
        my_list = service.create_list(set(bioent_format_names), GENE_OBJECT)
        
        enrichment = my_list.calculate_enrichment("go_enrichment_for_gene")
    
        enrichment_results = [(row["identifier"], row["matches"], row['p-value']) for row in enrichment]
        return enrichment_results
    else:
        return []

if __name__ == "__main__":
    
    format_gene_names = set(['Q0085',
'RDN25-1',
'YAL023C',
'YAL041W',
'YAL041W',
'YAL041W',
'YAL042C-A',
'YAL042W',
'YAL042W',
'YAL042W',
'YAL043C',
'YAL043C',
'YAL043C',
'YAL043C',
'YAL044C',
'YAL053W',
'YAL054C',
'YAL054C',
'YAL054C',
'YAL054C',
'YAL054C',
'YAL055W',
'YAL060W',
'YAR009C',
'YAR073W',
'YBL001C',
'YBL007C',
'YBL007C',
'YBL007C',
'YBL007C',
'YBL014C',
'YBL018C',
'YBL028C',
'YBL038W',
'YBL039C',
'YBL041W',
'YBL079W',
'YBL080C',
'YBL080C',
'YBL080C',
'YBL080C',
'YBL098W',
'YBL105C',
'YBR011C',
'YBR011C',
'YBR011C',
'YBR011C',
'YBR011C',
'YBR012W-B',
'YBR029C',
'YBR029C',
'YBR029C',
'YBR029C',
'YBR030W',
'YBR069C',
'YBR072W',
'YBR072W',
'YBR072W',
'YBR077C',
'YBR078W',
'YBR080C',
'YBR080C',
'YBR080C',
'YBR092C',
'YBR101C',
'YBR101C',
'YBR101C',
'YBR101C',
'YBR109C',
'YBR110W',
'YBR121C',
'YBR129C',
'YBR146W',
'YBR146W',
'YBR146W',
'YBR154C',
'YBR155W',
'YBR211C',
'YBR211C',
'YBR211C',
'YBR211C',
'YBR212W',
'YBR238C',
'YBR248C',
'YBR248C',
'YBR248C',
'YBR263W',
'YBR266C',
'YBR273C',
'YBR283C',
'YBR283C',
'YBR283C',
'YBR284W',
'YCL001W',
'YCL004W',
'YCL005W',
'YCL011C',
'YCL011C',
'YCL011C',
'YCL016C',
'YCL017C',
'YCL031C',
'YCL031C',
'YCL031C',
'YCL031C',
'YCL040W',
'YCL064C',
'YCR001W',
'YCR002C',
'YCR002C',
'YCR002C',
'YCR003W',
'YCR003W',
'YCR003W',
'YCR053W',
'YCR082W',
'YCR082W',
'YCR082W',
'YDL010W',
'YDL012C',
'YDL012C',
'YDL012C',
'YDL022W',
'YDL023C',
'YDL032W',
'YDL035C',
'YDL037C',
'YDL039C',
'YDL062W',
'YDL063C',
'YDL081C',
'YDL105W',
'YDL106C',
'YDL106C',
'YDL106C',
'YDL116W',
'YDL116W',
'YDL116W',
'YDL122W',
'YDL122W',
'YDL122W',
'YDL145C',
'YDL159W',
'YDL160C',
'YDL189W',
'YDL189W',
'YDL189W',
'YDL190C',
'YDL190C',
'YDL190C',
'YDL193W',
'YDL208W',
'YDL209C',
'YDR011W',
'YDR034C-A',
'YDR035W',
'YDR035W',
'YDR035W',
'YDR035W',
'YDR098C-B',
'YDR130C',
'YDR130C',
'YDR130C',
'YDR130C',
'YDR158W',
'YDR168W',
'YDR194C',
'YDR194C',
'YDR194C',
'YDR195W',
'YDR210C-C',
'YDR214W',
'YDR233C',
'YDR234W',
'YDR245W',
'YDR245W',
'YDR245W',
'YDR261C-D',
'YDR280W',
'YDR283C',
'YDR283C',
'YDR283C',
'YDR283C',
'YDR295C',
'YDR295C',
'YDR295C',
'YDR296W',
'YDR296W',
'YDR296W',
'YDR309C',
'YDR311W',
'YDR312W',
'YDR316W-A',
'YDR326C',
'YDR327W',
'YDR329C',
'YDR329C',
'YDR329C',
'YDR329C',
'YDR330W',
'YDR339C',
'YDR339C',
'YDR339C',
'YDR340W',
'YDR356W',
'YDR361C',
'YDR361C',
'YDR361C',
'YDR361C',
'YDR365W-B',
'YDR366C',
'YDR384C',
'YDR385W',
'YDR403W',
'YDR404C',
'YDR404C',
'YDR404C',
'YDR405W',
'YDR410C',
'YDR422C',
'YDR444W',
'YDR454C',
'YDR454C',
'YDR454C',
'YDR455C',
'YDR456W',
'YDR456W',
'YDR456W',
'YDR461W',
'YDR461W',
'YDR463W',
'YDR476C',
'YDR523C',
'YEL017C-A',
'YEL017W',
'YEL037C',
'YEL037C',
'YEL037C',
'YER023W',
'YER041W',
'YER041W',
'YER044C',
'YER091C',
'YER103W',
'YER137C-A',
'YER138C',
'YER138W-A',
'YER178W',
'YER187W',
'YER188W',
'YFL002W-A',
'YFL014W',
'YFL014W',
'YFL014W',
'YFL017W-A',
'YFL018C',
'YFL026W',
'YFL045C',
'YFL047W',
'YFL048C',
'YFL048C',
'YFL048C',
'YFR018C',
'YFR023W',
'YFR026C',
'YFR044C',
'YFR044C',
'YGL009C',
'YGL012W',
'YGL032C',
'YGL077C',
'YGL106W',
'YGL107C',
'YGL107C',
'YGL107C',
'YGL121C',
'YGL156W',
'YGL192W',
'YGL192W',
'YGL192W',
'YGL194C',
'YGL194C',
'YGL194C',
'YGL195W',
'YGL222C',
'YGL222C',
'YGL222C',
'YGL222C',
'YGL225W',
'YGL228W',
'YGL229C',
'YGR027W-B',
'YGR038C-B',
'YGR043C',
'YGR055W',
'YGR056W',
'YGR059W',
'YGR059W',
'YGR059W',
'YGR059W',
'YGR119C',
'YGR119C',
'YGR119C',
'YGR119C',
'YGR128C',
'YGR128C',
'YGR128C',
'YGR128C',
'YGR129W',
'YGR151C',
'YGR161C-D',
'YGR161W-B',
'YGR169C',
'YGR183C',
'YGR183C',
'YGR183C',
'YGR183C',
'YGR185C',
'YGR185C',
'YGR185C',
'YGR186W',
'YGR186W',
'YGR186W',
'YGR215W',
'YGR231C',
'YGR231C',
'YGR231C',
'YGR231C',
'YGR232W',
'YGR234W',
'YGR235C',
'YGR249W',
'YGR253C',
'YGR259C',
'YGR268C',
'YGR270W',
'YGR270W',
'YGR270W',
'YGR282C',
'YHL021C',
'YHL027W',
'YHL028W',
'YHL028W',
'YHL028W',
'YHL029C',
'YHL047C',
'YHR018C',
'YHR051W',
'YHR051W',
'YHR051W',
'YHR051W',
'YHR051W',
'YHR051W',
'YHR064C',
'YHR064C',
'YHR064C',
'YHR064C',
'YHR074W',
'YHR074W',
'YHR077C',
'YHR077C',
'YHR077C',
'YHR077C',
'YHR078W',
'YHR086W',
'YHR090C',
'YHR090C',
'YHR090C',
'YHR090C',
'YHR115C',
'YHR115C',
'YHR115C',
'YHR116W',
'YHR161C',
'YHR162W',
'YHR179W',
'YHR199C',
'YHR200W',
'YHR215W',
'YHR216W',
'YIL003W',
'YIL015W',
'YIL018W',
'YIL031W',
'YIL032C',
'YIL036W',
'YIL036W',
'YIL036W',
'YIL037C',
'YIL037C',
'YIL037C',
'YIL037C',
'YIL048W',
'YIL051C',
'YIL060W',
'YIL116W',
'YIL135C',
'YIL138C',
'YIL138C',
'YIL138C',
'YIL138C',
'YIL147C',
'YIL155C',
'YIL162W',
'YIR010W',
'YIR023W',
'YIR023W',
'YIR023W',
'YIR042C',
'YJL002C',
'YJL008C',
'YJL008C',
'YJL008C',
'YJL026W',
'YJL052W',
'YJL055W',
'YJL062W',
'YJL063C',
'YJL111W',
'YJL174W',
'YJL176C',
'YJL176C',
'YJL176C',
'YJL183W',
'YJL196C',
'YJL201W',
'YJL201W',
'YJL201W',
'YJL202C',
'YJR027W',
'YJR029W',
'YJR062C',
'YJR062C',
'YJR062C',
'YJR063W',
'YJR070C',
'YJR077C',
'YJR078W',
'YJR093C',
'YJR093C',
'YJR093C',
'YJR104C',
'YJR116W',
'YJR127C',
'YJR137C',
'YJR137C',
'YJR137C',
'YJR138W',
'YJR162C',
'YKL004W',
'YKL005C',
'YKL007W',
'YKL008C',
'YKL008C',
'YKL014C',
'YKL015W',
'YKL016C',
'YKL026C',
'YKL028W',
'YKL029C',
'YKL029C',
'YKL029C',
'YKL030W',
'YKL035W',
'YKL060C',
'YKL060C',
'YKL060C',
'YKL069W',
'YKL078W',
'YKL096W',
'YKL111C',
'YKL112W',
'YKL135C',
'YKL143W',
'YKL144C',
'YKL144C',
'YKL144C',
'YKL144C',
'YKL163W',
'YKL167C',
'YKL167C',
'YKL167C',
'YKL172W',
'YKL172W',
'YKL172W',
'YKL190W',
'YKL190W',
'YKL190W',
'YKL195W',
'YKL196C',
'YKL196C',
'YKL196C',
'YKL196C',
'YKL207W',
'YKL211C',
'YKR029C',
'YKR029C',
'YKR029C',
'YKR030W',
'YKR030W',
'YKR030W',
'YKR056W',
'YKR056W',
'YKR056W',
'YKR059W',
'YKR065C',
'YKR081C',
'YKR081C',
'YKR081C',
'YKR082W',
'YKR082W',
'YKR082W',
'YKR084C',
'YKR093W',
'YKR096W',
'YLL018C',
'YLL033W',
'YLL034C',
'YLL034C',
'YLL034C',
'YLL046C',
'YLL047W',
'YLL053C',
'YLR024C',
'YLR025W',
'YLR035C-A',
'YLR040C',
'YLR041W',
'YLR055C',
'YLR055C',
'YLR055C',
'YLR056W',
'YLR058C',
'YLR095C',
'YLR095C',
'YLR095C',
'YLR096W',
'YLR157C-B',
'YLR162W',
'YLR162W-A',
'YLR174W',
'YLR192C',
'YLR195C',
'YLR222C',
'YLR222C',
'YLR222C',
'YLR227W-B',
'YLR229C',
'YLR259C',
'YLR292C',
'YLR292C',
'YLR292C',
'YLR293C',
'YLR293C',
'YLR293C',
'YLR293C',
'YLR307W',
'YLR317W',
'YLR330W',
'YLR340W',
'YLR342W',
'YLR348C',
'YLR349W',
'YLR351C',
'YLR355C',
'YLR390W-A',
'YLR396C',
'YLR396C',
'YLR396C',
'YLR396C',
'YLR399C',
'YLR400W',
'YLR438W',
'YLR452C',
'YML007W',
'YML012C-A',
'YML012W',
'YML012W',
'YML012W',
'YML039W',
'YML040W',
'YML045W',
'YML045W-A',
'YML081W',
'YML107C',
'YMR005W',
'YMR033W',
'YMR045C',
'YMR046W-A',
'YMR050C',
'YMR051C',
'YMR060C',
'YMR060C',
'YMR060C',
'YMR060C',
'YMR061W',
'YMR062C',
'YMR085W',
'YMR092C',
'YMR092C',
'YMR092C',
'YMR093W',
'YMR120C',
'YMR129W',
'YMR158C-A',
'YMR169C',
'YMR197C',
'YMR197C',
'YMR197C',
'YMR198W',
'YMR200W',
'YMR260C',
'YMR260C',
'YMR260C',
'YMR260C',
'YMR296C',
'YMR296C',
'YMR296C',
'YMR297W',
'YNL036W',
'YNL037C',
'YNL043C',
'YNL044W',
'YNL054W-B',
'YNL055C',
'YNL057W',
'YNL059C',
'YNL059C',
'YNL059C',
'YNL072W',
'YNL081C',
'YNL085W',
'YNL116W',
'YNL117W',
'YNL117W',
'YNL117W',
'YNL118C',
'YNL118C',
'YNL118C',
'YNL119W',
'YNL119W',
'YNL119W',
'YNL121C',
'YNL121C',
'YNL121C',
'YNL149C',
'YNL149C',
'YNL149C',
'YNL153C',
'YNL183C',
'YNL183C',
'YNL183C',
'YNL189W',
'YNL212W',
'YNL213C',
'YNL243W',
'YNL244C',
'YNL244C',
'YNL244C',
'YNL255C',
'YNL255C',
'YNL255C',
'YNL258C',
'YNL258C',
'YNL258C',
'YNL258C',
'YNL267W',
'YNL267W',
'YNL267W',
'YNL284C-B',
'YNL287W',
'YNL306W',
'YNL306W',
'YNL306W',
'YNL307C',
'YNL307C',
'YNL307C',
'YNL312W',
'YNL312W',
'YNL312W',
'YNL313C',
'YNL313C',
'YNL313C',
'YNL321W',
'YNL322C',
'YNL322C',
'YNL339C',
'YNR037C',
'YNR037C',
'YNR037C',
'YNR037C',
'YNR038W',
'YNR044W',
'YNR046W',
'YNR053C',
'YOL014W',
'YOL026C',
'YOL036W',
'YOL039W',
'YOL068C',
'YOL068C',
'YOL068C',
'YOL068C',
'YOL076W',
'YOL076W',
'YOL076W',
'YOL077C',
'YOL077C',
'YOL077C',
'YOL086C',
'YOL103W-A',
'YOL103W-B',
'YOL104C',
'YOL116W',
'YOL116W',
'YOL116W',
'YOL126C',
'YOL155C',
'YOR045W',
'YOR056C',
'YOR057W',
'YOR116C',
'YOR116C',
'YOR116C',
'YOR117W',
'YOR192C-B',
'YOR194C',
'YOR205C',
'YOR205C',
'YOR205C',
'YOR205C',
'YOR206W',
'YOR230W',
'YOR232W',
'YOR236W',
'YOR261C',
'YOR261C',
'YOR261C',
'YOR261C',
'YOR262W',
'YOR289W',
'YOR309C',
'YOR310C',
'YOR343W-B',
'YOR348C',
'YOR357C',
'YPL012W',
'YPL013C',
'YPL013C',
'YPL013C',
'YPL036W',
'YPL037C',
'YPL087W',
'YPL111W',
'YPL111W',
'YPL111W',
'YPL131W',
'YPL159C',
'YPL159C',
'YPL159C',
'YPL228W',
'YPL232W',
'YPL242C',
'YPL242C',
'YPL242C',
'YPL242C',
'YPL257W-A',
'YPL257W-B',
'YPR017C',
'YPR017C',
'YPR017C',
'YPR017C',
'YPR018W',
'YPR028W',
'YPR036W',
'YPR077C',
'YPR104C',
'YPR128C',
'YPR128C',
'YPR128C',
'YPR129W',
'YPR136C',
'YPR148C',
'YPR157W',
'YPR158W-A',
'YPR158W-B',
'YPR172W',
'YPR176C',
'YPR176C',
'YPR176C',
'YPR178W',
'YPR178W',
'YPR178W',
'YPR186C',
'YPR186C',
'YPR186C',
'YPR187W',
'YPR187W',
'YPR187W',])
    print query_go_processes(format_gene_names)