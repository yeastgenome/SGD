<div metal:use-macro="layout">
  <div metal:fill-slot="content">


<body>
	
<!-- Subhead
================================================== -->
<header class="jumbotron subhead" id="overview">
	<div class="container">
		<h1><span tal:content="structure name"></h1>
	</div>
</header>

<div class="container-fluid">


<!-- Docs nav
================================================== -->
<div class="row-fluid">
	<div class="span3 bs-docs-sidebar">
		<ul class="nav nav-list bs-docs-sidenav" id='navbar' name='navbar' style="margin-left:auto; margin-right:auto">
			<li><h4><span tal:content="structure name_with_link"></h4></li>
			<li><a href="#evidence"><i class="icon-chevron-right"></i> Evidence</a></li>
          	<li><a href="#literature"><i class="icon-chevron-right"></i> References</a></li>
		</ul>
	</div>
	
	<div class="span9">  


<!-- Evidence
================================================== -->
<section id="evidence">
	<div class="page-header">
		<h1>Evidence <span id='evidence_header'></span></h1>
		<span>Source: SGD</span>
		
		<div tal:condition="python: not split" id='combined_evidence'>		
		<h3>Evidence <span id='evidence_header'></span></h3>
		<span id='evidence_message' class="hide">No evidence curated.</span>
		<div id='evidence_wrapper'>		
			<table class='table table-striped table-bordered table-condensed tablesorter' id='evidence_table' width="100%">
			<thead>
  			<tr>
  				<th>Phenotype</th>
  				<th>Gene</th>
    			<th>Qualifier</th>
    			<th>Experiment</th>
    			<th>Mutant</th>
    			<th>Allele</th>
    			<th>Reporter</th>
    			<th>Chemical</th>
    			<th>Strain</th>
    			<th>Source</th>
    			<th>Reference</th>
    			<th>Comments</th>
  			</tr>
  			</thead>
  			</table>
        </div>
		<br></br>
	</div>
		
		<div tal:condition="python: split" id='combined_evidence'>
		<h3>Cellular Phenotype Evidence <span id='cellular_evidence_header'></span></h3>
		<span id='cellular_evidence_message' class="hide">No cellular phenotypes curated.</span>
		<div id='evidence_wrapper'>		
			<table class='table table-striped table-bordered table-condensed tablesorter' id='cellular_evidence_table' width="100%">
			<thead>
  			<tr>
  				<th>Phenotype</th>
  				<th>Gene</th>
    			<th>Qualifier</th>
    			<th>Experiment</th>
    			<th>Mutant</th>
    			<th>Allele</th>
    			<th>Reporter</th>
    			<th>Chemical</th>
    			<th>Strain</th>
    			<th>Source</th>
    			<th>Reference</th>
    			<th>Comments</th>
  			</tr>
  			</thead>
  			</table>
        </div>
		<br></br>
		
		<h3>Chemical Phenotype Evidence <span id='chemical_evidence_header'></span></h3>
		<span id='chemical_evidence_message' class="hide">No chemical phenotypes curated.</span>
		<div id='chemical_evidence_wrapper'>		
			<table class='table table-striped table-bordered table-condensed tablesorter' id='chemical_evidence_table' width="100%">
			<thead>
  			<tr>
  				<th>Phenotype</th>
  				<th>Gene</th>
    			<th>Qualifier</th>
    			<th>Experiment</th>
    			<th>Mutant</th>
    			<th>Allele</th>
    			<th>Reporter</th>
    			<th>Chemical</th>
    			<th>Strain</th>
    			<th>Source</th>
    			<th>Reference</th>
    			<th>Comments</th>
  			</tr>
  			</thead>
  			</table>
        </div>
		<br></br>
		
		<h3>Protein/Peptide and RNA Phenotype Evidence <span id='pp_rna_evidence_header'></span></h3>
		<span id='pp_rna_evidence_message' class="hide">No protein/peptide and RNA phenotypes curated.</span>
		<div id='pp_rna_evidence_wrapper'>		
			<table class='table table-striped table-bordered table-condensed tablesorter' id='pp_rna_evidence_table' width="100%">
			<thead>
  			<tr>
  				<th>Phenotype</th>
  				<th>Gene</th>
    			<th>Qualifier</th>
    			<th>Experiment Type</th>
    			<th>Mutant</th>
    			<th>Allele</th>
    			<th>Reporter</th>
    			<th>Chemical</th>
    			<th>Strain</th>
    			<th>Source</th>
    			<th>Reference</th>
    			<th>Comments</th>
  			</tr>
  			</thead>
  			</table>
        </div>
		<br></br>
	</div>
		
	</div>
</section>

<!-- References
================================================== -->
<section id="literature">
	<div class="page-header">
		<h1>References</h1>
		<ul id='reference_list'>
		</ul>
	</div>
</section>

<script>
	$(document).ready(function() {
	
		//Set up evidence table and reference list
  		$.getJSON('${link_maker.phenotype_evidence_table_link}', function(data) {
  			
			var references = data['reference'];
			
			if('${split}') {
  				var cellular_evidence = data['cellular_pheno'];
  				var chemical_evidence = data['chemical_pheno'];
  				var pp_rna_evidence = data['pp_rna_pheno'];
  			
  				//Set total evidence count
				var num_rows = cellular_evidence.length + chemical_evidence.length + pp_rna_evidence.length;
				document.getElementById("evidence_header").innerHTML = '(' + num_rows + ')';
			
  				//Set up cellular evidence table
				var options = basic_datatable_options("cellular_evidence_header", 
					'${link_maker.cellular_phenotype_evidence_filename}', "cellular_evidence_wrapper", "cellular_evidence_message");
				options["aaData"] = cellular_evidence;
				options["aoColumns"] = [null, {"bSearchable":false, "bVisible":false}, null, null, null, null, null, null, null, {"bSearchable":false, "bVisible":false}, null, {"bSearchable":false, "bVisible":false}]
				options["aaSorting"] = [[0, "asc"]];
				var cellTable = $('#cellular_evidence_table').dataTable(options);
			
				//Set up chemical evidence table
				var options = basic_datatable_options("chemical_evidence_header", 
					'${link_maker.chemical_phenotype_evidence_filename}', "chemical_evidence_wrapper", "chemical_evidence_message");
				options["aaData"] = chemical_evidence;
				options["aoColumns"] = [null, {"bSearchable":false, "bVisible":false}, null, null, null, null, null, null, null, {"bSearchable":false, "bVisible":false}, null, {"bSearchable":false, "bVisible":false}]
				options["aaSorting"] = [[7, "asc"]];
				$('#chemical_evidence_table').dataTable(options);
			
				//Set up pp_rna evidence table
				var options = basic_datatable_options("pp_rna_evidence_header", 
					'${link_maker.pp_rna_phenotype_evidence_filename}', "pp_rna_evidence_wrapper", "pp_rna_evidence_message");
				options["aaData"] = pp_rna_evidence;
				options["aoColumns"] = [null, {"bSearchable":false, "bVisible":false}, null, null, null, null, null, null, null, {"bSearchable":false, "bVisible":false}, null, {"bSearchable":false, "bVisible":false}]
				options["aaSorting"] = [[6, "asc"]];
				$('#pp_rna_evidence_table').dataTable(options);
			}
			else {
				var evidence = data['aaData'];
				
				//Set total evidence count
				var num_rows = evidence.length
				document.getElementById("evidence_header").innerHTML = '(' + num_rows + ')';
			
  				//Set up evidence table
				var options = basic_datatable_options("evidence_header", 
					'${link_maker.phenotype_evidence_filename}', "evidence_wrapper", "evidence_message");
				options["aaData"] = evidence;
				options["aoColumns"] = [null, {"bSearchable":false, "bVisible":false}, null, null, null, null, null, null, null, {"bSearchable":false, "bVisible":false}, null, {"bSearchable":false, "bVisible":false}]
				options["aaSorting"] = [[0, "asc"]];
				$('#evidence_table').dataTable(options);
			}
			
			//Set up references
			ref_list = document.getElementById("reference_list");
			for (var i=0; i < references.length; i++) {
				var citation = references[i];
				var p=document.createElement('p');
				p.innerHTML = citation;
				ref_list.appendChild(p);
			}
			
			//Insert a 'details' column to the table
    		var nCloneTh = document.createElement( 'th' );
   			var nCloneTd = document.createElement( 'td' );
    		nCloneTd.className = "center";
    		var b = document.createElement('button');
    		b.className = 'btn btn-link';
    		b.innerHTML = '<i class="icon-plus-sign"></i>';
         	nCloneTd.appendChild(b);

    		$('#cellular_evidence_table thead tr').each( function () {
       	 		this.insertBefore( nCloneTh, this.childNodes[0] );
     
    		} );
     
    		$('#cellular_evidence_table tbody tr').each( function () {
    		    if(cellTable.fnGetData(this)[11] != null) {
					this.insertBefore(  nCloneTd.cloneNode( true ), this.childNodes[0] );
				}
				else {
					this.insertBefore(nCloneTh.cloneNode(true), this.childNodes[0]);
				}
   			} );
   			

   			$('#cellular_evidence_table tbody tr td button').click(function() {
   				var nTr = $(this).parents('tr')[0];
        		if ( cellTable.fnIsOpen(nTr) ) {
            		// This row is already open - close it
            	 	this.innerHTML = '<i class="icon-plus-sign"></i>';
            		cellTable.fnClose( nTr );
        		}
        		else {
            		// Open this row
            	this.innerHTML = '<i class="icon-minus-sign"></i>';
            	cellTable.fnOpen( nTr, cellTable.fnGetData(nTr)[11], 'details' );
        		}
   			});
			
  		});
  		
  		
	} );
</script>


</div>

</body>
</div>
</div>

